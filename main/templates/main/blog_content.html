<div class="max-w-7xl mx-auto p-6">
    <!-- Header Section -->
    <div class="text-center mb-12">
        <h1 class="text-4xl font-bold mb-4">Блог</h1>
        <p class="text-gray-600 text-lg max-w-2xl mx-auto">
            Новости, советы и истории из мира моды и стиля
        </p>
    </div>

    <!-- Blog Posts Grid -->
    {% if posts %}
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-12">
        {% for post in posts %}
        <article class="bg-white border border-gray-200 hover:border-gray-900 transition-all group">
            <!-- Post Image -->
            <div class="aspect-video overflow-hidden bg-gray-100">
                <img src="{{ post.image.url }}" 
                     alt="{{ post.title }}"
                     class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300">
            </div>
            
            <!-- Post Content -->
            <div class="p-6">
                <div class="flex items-center gap-2 text-sm text-gray-500 mb-3">
                    <span>{{ post.author }}</span>
                    <span class="w-1 h-1 bg-gray-400 rounded-full"></span>
                    <time datetime="{{ post.created_at|date:'Y-m-d' }}">
                        {{ post.created_at|date:"d.m.Y" }}
                    </time>
                </div>
                
                <h2 class="text-xl font-bold mb-3 line-clamp-2">{{ post.title }}</h2>
                
                <p class="text-gray-600 mb-4 line-clamp-3">{{ post.excerpt }}</p>
                
                <button 
                    hx-get="{% url 'main:blog' %}?post_slug={{ post.slug }}"
                    hx-target="#blog-modal"
                    hx-swap="innerHTML"
                    class="text-gray-900 font-semibold hover:underline inline-flex items-center gap-2">
                    Читать далее
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                </button>
            </div>
        </article>
        {% endfor %}
    </div>

    <!-- Pagination -->
    {% if paginator.num_pages > 1 %}
    <div class="flex justify-center items-center gap-2 mb-12">
        {% if posts.has_previous %}
        <a href="?page=1"
           hx-get="{% url 'main:blog' %}?page=1"
           hx-target="#content"
           hx-swap="innerHTML"
           hx-push-url="true"
           class="px-4 py-2 border border-gray-300 hover:bg-gray-100 transition-colors">
            «
        </a>
        <a href="?page={{ posts.previous_page_number }}"
           hx-get="{% url 'main:blog' %}?page={{ posts.previous_page_number }}"
           hx-target="#content"
           hx-swap="innerHTML"
           hx-push-url="true"
           class="px-4 py-2 border border-gray-300 hover:bg-gray-100 transition-colors">
            ‹
        </a>
        {% endif %}

        {% for num in posts.paginator.page_range %}
            {% if posts.number == num %}
            <span class="px-4 py-2 bg-gray-900 text-white font-semibold">{{ num }}</span>
            {% elif num > posts.number|add:'-3' and num < posts.number|add:'3' %}
            <a href="?page={{ num }}"
               hx-get="{% url 'main:blog' %}?page={{ num }}"
               hx-target="#content"
               hx-swap="innerHTML"
               hx-push-url="true"
               class="px-4 py-2 border border-gray-300 hover:bg-gray-100 transition-colors">
                {{ num }}
            </a>
            {% endif %}
        {% endfor %}

        {% if posts.has_next %}
        <a href="?page={{ posts.next_page_number }}"
           hx-get="{% url 'main:blog' %}?page={{ posts.next_page_number }}"
           hx-target="#content"
           hx-swap="innerHTML"
           hx-push-url="true"
           class="px-4 py-2 border border-gray-300 hover:bg-gray-100 transition-colors">
            ›
        </a>
        <a href="?page={{ posts.paginator.num_pages }}"
           hx-get="{% url 'main:blog' %}?page={{ posts.paginator.num_pages }}"
           hx-target="#content"
           hx-swap="innerHTML"
           hx-push-url="true"
           class="px-4 py-2 border border-gray-300 hover:bg-gray-100 transition-colors">
            »
        </a>
        {% endif %}
    </div>
    {% endif %}
    {% else %}
    <div class="text-center py-16">
        <p class="text-gray-500 text-lg">Пока нет опубликованных статей</p>
    </div>
    {% endif %}

    <!-- Newsletter Subscription Section -->
    <div class="bg-gray-900 text-white p-8 md:p-12 text-center">
        <h2 class="text-3xl font-bold mb-4">Подпишитесь на рассылку</h2>
        <p class="text-gray-300 mb-6 max-w-2xl mx-auto">
            Получайте последние новости, эксклюзивные предложения и советы по стилю прямо на почту
        </p>
        
        <div class="max-w-md mx-auto">
            <button 
                id="subscribe-btn"
                onclick="handleSubscribe(this)"
                class="w-full bg-white text-gray-900 py-3 px-6 font-semibold hover:bg-gray-100 transition-colors">
                Подписаться
            </button>
        </div>
    </div>
</div>

<!-- Modal Container for Blog Posts -->
<div id="blog-modal"></div>

<script>
function handleSubscribe(btn) {
    // Toggle subscription state
    if (btn.classList.contains('subscribed')) {
        btn.classList.remove('subscribed', 'bg-green-500');
        btn.classList.add('bg-white');
        btn.textContent = 'Подписаться';
    } else {
        btn.classList.add('subscribed', 'bg-green-500');
        btn.classList.remove('bg-white');
        btn.textContent = 'Вы подписаны ✓';
    }
}
</script>
